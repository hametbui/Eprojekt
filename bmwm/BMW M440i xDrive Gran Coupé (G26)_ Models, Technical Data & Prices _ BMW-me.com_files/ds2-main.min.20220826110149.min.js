window.digitals2=window.digitals2||{};window.digitals2.main=window.digitals2.main||{};window.digitals2.main.cqIsInEditMode=!1;window.CQ&&window.CQ.WCM&&window.CQ.WCM.isEditMode()&&!window.CQ.WCM.isPreviewMode()&&(window.digitals2.main.cqIsInEditMode=!0);
define("ds2-main","jquery ds2-animation lodash componentInitializer ds2-resize-events ds2-cookie-controller".split(" "),function(c,t,w,r,u){function p(){this.$window=c(window);this.animation=new t;this.initTrigger()}var a=p.prototype;a.initTrigger=function(){this.init();this.$window.trigger("initializeComponents");this.delayLinkAction();this.checkCQMode();this.cqIsInEditMode||this.positionFooter();this.navigationElementControl();this.layerInit()};a.init=function(){this.scrollToAnkers=!0;c.fn.hasAttr=
function(b){return void 0!==this.attr(b)};this.checkCQMode();this.policyConformationIsRequired;this.externalCommunicationInit();this.$window.on("message onmessage",function(b){var d=b.originalEvent;b=d.origin;d=d.data;var a=null;try{a=JSON.parse(d)}catch(f){}null!=a&&0<=b.indexOf(".bmw.")&&"changeIdModule"===a.type&&a.imgSrc&&c(".ds2-navigation-main--id-module").find("img").attr("src",a.imgSrc)});if(this.checkLoaded())this.jumpToAnchor();else this.$window.on("load",this.jumpToAnchor());this.checkFrame();
this.initializeGcdmOnVCOForm();setTimeout(function(){var b;window.consentcontroller&&window.consentcontroller.api&&(b=window.consentcontroller.api.getPersistence("gcdm-accessToken"));window.ds2configurator&&b&&window.ds2configurator.$.publish("h5vco.account.loggedIn",[!0])},100)};a.checkLoaded=function(){return"complete"===document.readyState};a.jumpToAnchor=function(){var b=window.location.hash.replace(/#\//g,"");if(""!==b){try{var d=c(b)}catch(f){return!1}if(d.length){var a=document.documentElement.style.overflow;
document.body.style.overflow="hidden";r.initElement(c(".ds2-uxn-navigation-content-bar"));c("html, body").animate({scrollTop:d[0].offsetTop+"px"},{duration:3E3,step:function(b,a){b=d.offset().top;a.end!==b&&(a.end=b)},always:function(){c(".ds2-anchor-wall").hide();document.body.style.overflow=a}})}else c(".ds2-anchor-wall").hide()}else c(".ds2-anchor-wall").hide()};a.checkCQMode=function(){window.CQ&&window.CQ.WCM&&window.CQ.WCM.isEditMode()&&!window.CQ.WCM.isPreviewMode()&&(this.cqIsInEditMode=!0)};
a.delayLinkAction=function(){c("a").each(function(){var b=this.hash;if(b&&0<b.length&&!(0<b.indexOf("/"))){var a=this.pathname,e=c(this);e.on("click",function(d){d.preventDefault();a&&window.location.pathname===a&&0<document.querySelectorAll("img[data-src].ds2-slider--img:not([data-was-processed])").length&&(window.location.hash=b);setTimeout(function(){"_blank"===e.attr("target")?window.open(e.attr("href"),"_blank"):window.location.href=e.attr("href")},100)})}})};a.layerInit=function(){var b=this,
a;c(".ds2-login-js--layer-opener").on("click",function(){var d=c(this);a=d.data("layerId");b.loginOpendFromExternal=d.data("layerNoRedirect");b.openLayer(a)})};a.externalCommunicationInit=function(){var b=this,a=c(document);window.ds2configurator&&(ds2configurator.$.subscribe("h5vco.account.openLogin",function(){b.loginOpenFromExternal()}),ds2configurator.$.subscribe("h5vco.account.openLoginThroughSaveButton",function(){b.loginOpenThroughSaveButtonFromExternal()}));a.on("ds2-reactionAfterLogin",function(){b.reactionAfterLogin()});
a.on("ds2-policyConformationRequired",function(){b.policyConformationRequired()});a.on("ds2-reactionAfterRegistration",function(){b.reactionAfterRegistration()});a.on("ds2-reactionAfterReregistration",function(){b.reactionAfterReRegistration()});a.on("ds2-reRegistrationRequired",function(){b.reRegistrationRequired()});a.on("ds2-dlo-error",function(){b.openLayer("ds2-messages-js--dlo-error")});c("#ds2-messages-js--dlo-error").find(".close").on("click",function(){b.closeLayer("ds2-messages-js--dlo-error")});
a.on("ds2-gcdmDownError-invokedFromPage",function(){c("[data-lightbox-id\x3dgcdmError]").find(".ds2-dialog-button--show-for-layer").addClass("hide");c("[data-lightbox-id\x3dgcdmError]").find(".ds2-dialog-button--show-for-page").removeClass("hide");b.openLightbox("gcdmError")});a.on("ds2-gcdmDownError-invokedFromLayer",function(){c("[data-lightbox-id\x3dgcdmError]").find(".ds2-dialog-button--show-for-layer").removeClass("hide");c("[data-lightbox-id\x3dgcdmError]").find(".ds2-dialog-button--show-for-page").addClass("hide");
b.openLightbox("gcdmError")})};a.redirectAfterLogin=function(){a.loginOpendFromExternal&&(a.loginOpendFromExternalThroughSaveButton?ds2configurator.$.publish("h5vco.account.closeRegisterThroughSaveButton"):0==c("form[d2-campaign-required-login]").length&&(targetUrl=c("#loginform").data("redirectGarage"),a.redirectToTargetPage(targetUrl)))};a.reactionAfterLogin=function(){a.closeLayer("gcdmLogin");a.closeLayer("gcdmPolicy");a.loginSuccessful=!0;a.registrationSuccessful||a.redirectAfterLogin()};a.reRegistrationRequired=
function(){a.closeLayer("gcdmPolicy");a.closeLayer("gcdmLogin");a.openLayer("gcdmReregistration")};a.reactionAfterReRegistration=function(){a.closeLayer("gcdmReregistration");a.reactionAfterLogin()};a.reactionAfterRegistration=function(){a.registrationSuccessful=!0;var b=c(".ds2-registration--button-save","[data-lightbox-id\x3dgcdmRegistration]"),d=c(".ds2-registration--button-end","[data-lightbox-id\x3dgcdmRegistration]");a.loginOpendFromExternal?(b.on("click",a.redirectAfterLogin),d.on("click",
a.redirectAfterLogin),a.loginOpendFromExternalThroughSaveButton&&(b.removeClass("hide"),d.addClass("hide"))):(b.addClass("hide"),d.removeClass("hide"))};a.policyConformationRequired=function(){this.policyConformationIsRequired=!0;document.querySelector("[data-lightbox-id\x3dgcdmPolicy] [gcdm-policy-confirmation]").classList.remove("ng-hide");this.closeLayer("gcdmLogin");this.openLayer("gcdmPolicy")};a.loginOpenFromExternal=function(){a.loginOpendFromExternal=!0;a.addGcdmMarkup().then(function(){a.openLayer("gcdmLogin")})};
a.loginOpenThroughSaveButtonFromExternal=function(){a.loginOpendFromExternal=!0;a.loginOpendFromExternalThroughSaveButton=!0;a.addGcdmMarkup().then(function(){a.openLayer("gcdmLogin")})};a.redirectToTargetPage=function(b){b&&(window.location=b)};a.closeLayer=function(b){(b=document.querySelector("[data-lightbox-id\x3d"+b+"]"))&&b.Lightbox&&b.Lightbox.closeLightbox()};var q;a.addGcdmMarkup=function(){if(q)return q;var b=c.Deferred(),a=c("#ng-app"),e=a.find("[data-lightbox-id\x3dgcdmLogin] .ds2-lightbox__container").children().length,
f={},v=a.find("[data-modalpath]"),m=function(b,a){var d=c.Deferred();return{d:d,resolve:function(){b.find(".ds2-lightbox__container").load(a+".html?wcmmode\x3ddisabled",function(a,c){"error"!==c?(b.attr("data-component-initialized")&&b.attr("data-component-initialized",!1),d.resolve(a)):(d.reject(c),console.log(c))})}}},k=function(){v.each(function(){var b=c(this),a=b.data("modalpath"),d=b.attr("id")||b.data("lightbox-id");f[d]=new m(b,a)})},l=function(){Object.keys(f).map(function(b){f[b].resolve()})},
n,g=function(){setTimeout(function(){r.initAll(a)},1E3);n=document.createEvent("Event");n.initEvent("ds2-lightbox-ready",!1,!1);for(var d=document.querySelectorAll(".ds2-lightbox"),c=0;c<d.length;c++)d[c].dispatchEvent(n);b.resolve()};!e&&a?(this.loadingAnimation().onMarkupRequestStart(),k(),c.when(f.gcdmLogin.d,f.gcdmForgottenPassword.d,f.gcdmRegistration.d,f.gcdmReregistration.d,f.gcdmPolicy.d).then(g).fail(g),l()):b.resolve();return q=b.promise()};a.loadingAnimation=function(){var b=c("#ds2-gcdm-placeholder__container");
return{onMarkupRequestStart:function(){b.addClass("ds2-image-loader--preloader-wrapper")},onMarkupRequestEnd:function(){setTimeout(function(){b.removeClass("ds2-image-loader--preloader-wrapper")},10)}}};a.waitForGcdmInit=function(){var b=c.Deferred(),a=0,e=function(){nn.global.ngAppInitalized||5<a++?b.resolve():setTimeout(e,500)};e();return b.promise()};var g;a.loadGcdmJs=function(){if(g)return g;var b=c("#ds2-lightbox-container"),a=b.data("angularapi-url"),e=b.data("gcdmformapi-url"),f=b.data("formsapi-url");
b=[];a&&e?(b.push({url:a,isLoaded:function(){return c.isPlainObject(window.angular)}}),b.push({url:e,isLoaded:function(){return c.isPlainObject(window.gcdm)}}),b.push({url:f,isLoaded:function(){return!!document.querySelectorAll('head \x3e script[src\x3d"'+f+'"]').length}}),g=this.lazyLoadScriptMulti(b).then(this.waitForGcdmInit.bind(this))):g=c.when();return g};a.openLayer=function(b){var a=this;a.loadGcdmJs().then(function(){a.openLightbox(b);console.log(window.angular);console.log(window.gcdm);
a.loadingAnimation().onMarkupRequestEnd()}).fail(function(a){console.log(a)})};a.openLightbox=function(a){var b=document.querySelector("[data-lightbox-id\x3d"+a+"]");b&&b.Lightbox?b.Lightbox.openLightbox():b.addEventListener("ds2-lightbox-initialized",function(){b.Lightbox&&b.Lightbox.openLightbox()})};a.initializeGcdmOnVCOForm=function(){var a=this;c("#vco").length&&a.addGcdmMarkup().then(a.loadGcdmJs.bind(a)).then(function(){a.loadingAnimation().onMarkupRequestEnd()})};a.lazyLoadScriptMulti=function(a){function b(){p++;
p===m&&0!==m&&f.resolve()}function e(){for(var a;k[0]&&"loaded"===k[0].readyState;)a=k.shift(),a.onreadystatechange=null,l.parentNode.insertBefore(a,l),b()}var f=c.Deferred(),g=0,m=0,k=[],l=document.scripts[document.scripts.length-1],n="async"in l,p=0;scriptsToLoad=function(a){for(var b=[],d,e=0,f=a.length;e<f;e++)d=a[e],c.isFunction(d.isLoaded)&&d.isLoaded()||b.push(d);return b}(a);if(m=scriptsToLoad.length){for(;g<m;g++){a=scriptsToLoad[g];var h=document.createElement("script");n?(h.async=!1,h.onload=
b,h.src=a.url,document.head.appendChild(h)):l.readyState?(k.push(h),h.onreadystatechange=e,h.src=a.url):(h.defer="defer",h.onload=b,h.src=a.url,document.body.appendChild(h))}window.setTimeout(function(){f.reject()},1E4)}else f.resolve();return f.promise()};a.isIOS=function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream};a.componentsUpdate=function(){window.digitals2.main.$window.trigger("initializeComponents")};a.checkFrame=function(){window.self!==window.top&&window.self&&
window.self.document&&window.self.document.body&&c(window.self.document.body).addClass("ds2-iframe--body")};a.navigationElementControl=function(){var a=c(".ds2-stage-presentation.ds2-contentnavigation"),d=c(".ds2-subbrand-icon--wrapper"),e=c(".ds2-subbrand-icon--spacing__below-text");d=d.length&&d.parents(".ds2-subbrand-icon--spacing__below-text").length;a&&d&&e.css("margin-top","35px")};a.positionFooter=function(){var a=c(window),d=function(){var b=c("footer"),d=c("main"),g=c(".ds2-navigation-main").height();
b=b.height()+parseInt(b.css("padding-top"));var m=d.height(),k=a.height(),l=c("main").find("iframe"),n=c(l).attr("id");g+m<k&&(0==l.length||n&&0!=n.indexOf("externalContentIFrame"))&&d.css("min-height",k-g-b)};d();a.on("resize",d)};window.digitals2.main=void 0;window.digitals2.main=new p;window.digitals2.main.supportsPassiveEventListeners=function(){var a=!1;try{var c=Object.defineProperty({},"passive",{get:function(){return a=!0}});window.addEventListener("testPassive",null,c);window.removeEventListener("testPassive",
null,c)}catch(e){a=!1}return a};window.digitals2.resizeEvents=new u;return p});requirejs(["ds2-main"],function(c){});