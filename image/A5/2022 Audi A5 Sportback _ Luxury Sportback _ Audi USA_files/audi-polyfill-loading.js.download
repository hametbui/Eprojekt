/*! @audi/audi-core-polyfills 6.1.1 - Fri, 08 Jul 2022 14:44:22 GMT
License information can be found in audi-polyfill-loading.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("core-polyfill-loading",[],t):"object"==typeof exports?exports["core-polyfill-loading"]=t():e["core-polyfill-loading"]=t()}(self,(function(){return function(){"use strict";var e,t,r,i={d:function(e,t){for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r:function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},n={};i.r(n),i.d(n,{imageLoadingPolyfill:function(){return o}});class s{constructor(){if(s._instance)return s._instance;this._initialize(),s._instance=this}_initialize(){this.registeredEvents=[],this.intersectionObserver=this._createIntersectionObserver(),this._applyPolyfill=this._applyPolyfill.bind(this),this._onIntersection=this._onIntersection.bind(this),this._applyPolyfill()}static _isSafariBrowser(){const e=navigator.userAgent.toLowerCase();return-1!==e.indexOf("safari")&&!(e.indexOf("chrome")>-1)}_createIntersectionObserver(){const e={lazyloadImage:'img[loading="lazy"]',rootMargin:"0px 0px 256px 0px",threshold:.01};if("IntersectionObserver"in window)return new IntersectionObserver(this._onIntersection,e)}_onIntersection(e,t){e.forEach((function(e){if(0===e.intersectionRatio)return;const r=e.target;t.unobserve(r),s._setImageSource(r)}))}static _setImageSource(e){s._setPictureSources(e),setTimeout((()=>{e.dataset.srcset&&(e.srcset=e.dataset.srcset),e.dataset.src&&(e.src=e.dataset.src)}),this._delay)}static _setPictureSources(e){if(e.parentNode&&"picture"===e.parentNode.tagName.toLowerCase()){const t=e.parentNode.querySelectorAll("source");Array.prototype.slice.call(t).forEach((function(e){e.dataset.srcset&&(e.srcset=e.dataset.srcset)}))}}_applyPolyfill(e){const t=e&&e.element?e.element:document,r=t.querySelectorAll('img[loading="lazy"]'),i=Array.prototype.slice.call(r),n=t.querySelectorAll('img[loading="eager"]'),o=Array.prototype.slice.call(n),l=this._isIntersectionObserverAvailable(),a=this._isScrollingPossible();if(l&&a){const e=this;i.forEach((function(t){e._observeWithIntersectionObserver(t)})),o.forEach((function(e){s._setImageSource(e)})),this._enablePrintingFallback(i)}else s._setAllImageSources(i),s._setAllImageSources(o)}_isIntersectionObserverAvailable(){return void 0!==this.intersectionObserver}_isScrollingPossible(){return void 0!==window.onscroll}_observeWithIntersectionObserver(e){this.intersectionObserver.observe(e)}_enablePrintingFallback(e){const t=window.matchMedia("print");this._handlePrintingFallback=this._handlePrintingFallback.bind(e),t.addListener(this._handlePrintingFallback)}_handlePrintingFallback(e){const t=this;e.matches&&s._setAllImageSources(t)}static _setAllImageSources(e){e.forEach((function(e){s._setImageSource(e)}))}registerCustomEvent(e){-1===this.registeredEvents.indexOf(e)&&(this.registeredEvents.push(e),document.addEventListener(e,this._applyPolyfill))}}e=s,t="_delay",r=s._isSafariBrowser()?100:0,t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r;const o=new s;return o.registerCustomEvent("PAGE_LOADED"),o.registerCustomEvent("LAYER_LOADED"),o.registerCustomEvent("ONELAYER_LOADED"),o.registerCustomEvent("content_rendered"),n}()}));
//# sourceMappingURL=audi-polyfill-loading.js.map