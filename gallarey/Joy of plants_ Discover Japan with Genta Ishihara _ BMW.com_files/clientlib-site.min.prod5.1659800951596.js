/*! For license information please see site.js.LICENSE.txt */
!function(){"use strict";const e=()=>{let e=document.querySelectorAll(".pwh:not(.initialized)");Array.from(e).forEach((e=>{(e=>{p(10,"Init"),e.classList.add("initialized");const t=u(document.location.href),r=d(document.location.href),n=document.referrer,i=u(n),a=d(n),o=sessionStorage.getItem("PW::locale");p("documentDomain",t),p("referrer",n),p("referrerDomain",i),p("referrerLocale",a),p("storedLocale",o);let s=null;if(""!==n&&t===i)if(null!==o){const e=!c(o);a===r&&e&&(s=o)}else{const e=!c(a);a!==r&&e&&(s=a)}function c(e=""){const t=document.querySelector('link[hreflang="'+e+'"]');return p("existPageInLocale",t),null!=t}function l(e="",t=""){const r=JSON.parse((n=e,n.replaceAll("'",'"')))[t];var n;if(r)return r}function u(e=""){try{return/^(?:https?:\/\/)?(?:[^@\n]+@)?(?:www\.)?([^:\/\n\?\=]+)/im.exec(e)[1]}catch(e){}}function d(e=""){const t=/\/(?<locale>[a-z]{2}|[a-z]{2}_[a-zA-Z]{2})\//g.exec(e);try{const{locale:e}=t.groups;return e.includes("_")?e.split("_")[0]:e}catch(e){}}function p(e="",t=""){try{"true"===localStorage.getItem("PW::debug")&&console.log("*** Locale Preserver: ",e,"-",t)}catch(e){}}s?(p("store locale",s),function(e=""){""!==e&&sessionStorage.setItem("PW::locale",e)}(s),function(e=""){const t=document.querySelectorAll(".pwh__ln a"),r=document.querySelector(".pwh__s form"),n=document.querySelector("a.pwh__l");if(t.length&&t.forEach((t=>{const{altHref:r}=t.dataset;if(r){const n=l(r,e);n&&t.setAttribute("href",n)}})),null!==r){const{altActions:t}=r.dataset;if(t){const n=l(t,e);n&&r.setAttribute("action",n)}}if(null!==n){const{altHref:t}=n.dataset;if(t){const r=l(t,e);r&&n.setAttribute("href",r)}}}(s)):(p("reset stored locale"),sessionStorage.removeItem("PW::locale"))})(e)}))},t="started",r="stopped",n="ended";let i;function a(e){d(20,"init",e),e.classList.add("initialized"),i=function(e){let t=e.textContent,r=JSON.parse(t||""),n={language:r.language||"en",currency:r.currency||"eur",template:r.template||"customPage",pageName:r.page||"home",referenceName:r.reference||"local > "+(r.template||"customPage"),version:r.version||"",isErrorPage:r.error||"",scriptUrl:r.script||"",isTracyAvailable:""!=(r.script||"")};return d(30,"trackConfig: ",n),n}(e),i.isErrorPage?c():s(),o(document)}function o(e){e.querySelectorAll('a:not([target^="_blank"])').forEach((e=>{if(!e.classList.contains("pwp__notification-button")){const t=e.href,r=e.getAttribute("data-track")||e.innerText.trim()||"Undefined";e.addEventListener("click",(()=>l("internal",r,t)))}})),e.querySelectorAll('a[target^="_blank"]').forEach((e=>{if(!e.classList.contains("pwp__notification-button")){const t=e.href,r=e.getAttribute("data-track")||e.innerText.trim()||"Undefined";e.addEventListener("click",(()=>l("external",r,t)))}}))}const s=()=>{d(40,"trackPage");let e={author:"JvM TECH",brand:"bmw",countryCode:"global",currency:i.currency,lang:i.language,pageVariant:"real page",pageType:i.template,stocklocatorType:"none"};i.version&&(e.version=i.version),i.pageName&&(e.pageName=i.pageName),d(42,"arguments: "+i.referenceName,e),i.isTracyAvailable&&window.tracy&&window.tracy.page(i.referenceName,e)},c=()=>{d(50,"trackError");let e={countryCode:"CC",errorMessage:"page not loaded",eventAction:"page load",errorType:"backend",errorCode:"404",requestedURL:window.location.href};d(52,"arguments: "+i.referenceName,e),i.isTracyAvailable&&window.tracy&&window.tracy.event(i.referenceName,e)},l=(e,t,r)=>{d(70,"trackLinkEvent");let n="local > "+e+" link clicked",a={linkName:t,requestedUrl:r,pageName:i.pageName};d(72,"arguments: "+n,a),i.isTracyAvailable&&window.tracy&&window.tracy.event(n,a)},u=(e,t,r,n,a)=>{d(80,"trackMediaEvent");let o="local > media ${ EVEN }",s={linkName:t+"::"+e,requestedUrl:r,pageName:i.pageName,mediaName:r,mediaTotalLength:n,mediaCurrentTime:a};d(82,"arguments: "+o,s),i.isTracyAvailable&&window.tracy&&window.tracy.event(o,s)};function d(e,t,r){try{"true"===localStorage.getItem("PW::debug")&&(r?console.log("*** Tracking: ",e,"-",t,r):console.log("*** Tracking: ",e,"-",t))}catch(e){}}const p=e=>{d(15,"updateTracking"),function(e){d(25,"initElement",e),o(e)}(e)};function h(e,t){t.autoplay||u(e,"audio",t.currentSrc,Math.round(t.duration),Math.round(t.currentTime))}const f=(e=document)=>{const i=e.querySelectorAll(".pw-a-audio:not(.initialized)");Array.from(i).forEach((e=>{(e=>{e.classList.add("initialized");const i=e.querySelector("audio"),a="pw-a-audio--is-playing";if(i){e.style.cursor="pointer";const o=()=>e.classList.add(a),s=()=>e.classList.remove(a);i.addEventListener("playing",(()=>{o(),h(t,i)})),i.addEventListener("pause",(()=>{s(),h(r,i)})),i.addEventListener("ended",(()=>{s(),h(n,i)})),e.addEventListener("click",(()=>{e.classList.contains(a)?i.pause():i.play()}))}})(e)}))};var y=Object.prototype.toString,m=Array.isArray||function(e){return"[object Array]"===y.call(e)};function g(e){return"function"==typeof e}function E(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function v(e,t){return null!=e&&"object"==typeof e&&t in e}var w=RegExp.prototype.test;var _=/\S/;function S(e){return!function(e,t){return w.call(e,t)}(_,e)}var T={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};var b=/\s*/,L=/\s+/,A=/\s*=/,N=/\s*\}/,U=/#|\^|\/|>|\{|&|=|!/;function q(e){this.string=e,this.tail=e,this.pos=0}function k(e,t){this.view=e,this.cache={".":this.view},this.parent=t}function R(){this.templateCache={_cache:{},set:function(e,t){this._cache[e]=t},get:function(e){return this._cache[e]},clear:function(){this._cache={}}}}q.prototype.eos=function(){return""===this.tail},q.prototype.scan=function(e){var t=this.tail.match(e);if(!t||0!==t.index)return"";var r=t[0];return this.tail=this.tail.substring(r.length),this.pos+=r.length,r},q.prototype.scanUntil=function(e){var t,r=this.tail.search(e);switch(r){case-1:t=this.tail,this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,r),this.tail=this.tail.substring(r)}return this.pos+=t.length,t},k.prototype.push=function(e){return new k(e,this)},k.prototype.lookup=function(e){var t,r,n,i=this.cache;if(i.hasOwnProperty(e))t=i[e];else{for(var a,o,s,c=this,l=!1;c;){if(e.indexOf(".")>0)for(a=c.view,o=e.split("."),s=0;null!=a&&s<o.length;)s===o.length-1&&(l=v(a,o[s])||(r=a,n=o[s],null!=r&&"object"!=typeof r&&r.hasOwnProperty&&r.hasOwnProperty(n))),a=a[o[s++]];else a=c.view[e],l=v(c.view,e);if(l){t=a;break}c=c.parent}i[e]=t}return g(t)&&(t=t.call(this.view)),t},R.prototype.clearCache=function(){void 0!==this.templateCache&&this.templateCache.clear()},R.prototype.parse=function(e,t){var r=this.templateCache,n=e+":"+(t||I.tags).join(":"),i=void 0!==r,a=i?r.get(n):void 0;return null==a&&(a=function(e,t){if(!e)return[];var r,n,i,a=!1,o=[],s=[],c=[],l=!1,u=!1,d="",p=0;function h(){if(l&&!u)for(;c.length;)delete s[c.pop()];else c=[];l=!1,u=!1}function f(e){if("string"==typeof e&&(e=e.split(L,2)),!m(e)||2!==e.length)throw new Error("Invalid tags: "+e);r=new RegExp(E(e[0])+"\\s*"),n=new RegExp("\\s*"+E(e[1])),i=new RegExp("\\s*"+E("}"+e[1]))}f(t||I.tags);for(var y,g,v,w,_,T,k=new q(e);!k.eos();){if(y=k.pos,v=k.scanUntil(r))for(var R=0,O=v.length;R<O;++R)S(w=v.charAt(R))?(c.push(s.length),d+=w):(u=!0,a=!0,d+=" "),s.push(["text",w,y,y+1]),y+=1,"\n"===w&&(h(),d="",p=0,a=!1);if(!k.scan(r))break;if(l=!0,g=k.scan(U)||"name",k.scan(b),"="===g?(v=k.scanUntil(A),k.scan(A),k.scanUntil(n)):"{"===g?(v=k.scanUntil(i),k.scan(N),k.scanUntil(n),g="&"):v=k.scanUntil(n),!k.scan(n))throw new Error("Unclosed tag at "+k.pos);if(_=">"==g?[g,v,y,k.pos,d,p,a]:[g,v,y,k.pos],p++,s.push(_),"#"===g||"^"===g)o.push(_);else if("/"===g){if(!(T=o.pop()))throw new Error('Unopened section "'+v+'" at '+y);if(T[1]!==v)throw new Error('Unclosed section "'+T[1]+'" at '+y)}else"name"===g||"{"===g||"&"===g?u=!0:"="===g&&f(v)}if(h(),T=o.pop())throw new Error('Unclosed section "'+T[1]+'" at '+k.pos);return function(e){for(var t,r=[],n=r,i=[],a=0,o=e.length;a<o;++a)switch((t=e[a])[0]){case"#":case"^":n.push(t),i.push(t),n=t[4]=[];break;case"/":i.pop()[5]=t[2],n=i.length>0?i[i.length-1][4]:r;break;default:n.push(t)}return r}(function(e){for(var t,r,n=[],i=0,a=e.length;i<a;++i)(t=e[i])&&("text"===t[0]&&r&&"text"===r[0]?(r[1]+=t[1],r[3]=t[3]):(n.push(t),r=t));return n}(s))}(e,t),i&&r.set(n,a)),a},R.prototype.render=function(e,t,r,n){var i=this.getConfigTags(n),a=this.parse(e,i),o=t instanceof k?t:new k(t,void 0);return this.renderTokens(a,o,r,e,n)},R.prototype.renderTokens=function(e,t,r,n,i){for(var a,o,s,c="",l=0,u=e.length;l<u;++l)s=void 0,"#"===(o=(a=e[l])[0])?s=this.renderSection(a,t,r,n,i):"^"===o?s=this.renderInverted(a,t,r,n,i):">"===o?s=this.renderPartial(a,t,r,i):"&"===o?s=this.unescapedValue(a,t):"name"===o?s=this.escapedValue(a,t,i):"text"===o&&(s=this.rawValue(a)),void 0!==s&&(c+=s);return c},R.prototype.renderSection=function(e,t,r,n,i){var a=this,o="",s=t.lookup(e[1]);if(s){if(m(s))for(var c=0,l=s.length;c<l;++c)o+=this.renderTokens(e[4],t.push(s[c]),r,n,i);else if("object"==typeof s||"string"==typeof s||"number"==typeof s)o+=this.renderTokens(e[4],t.push(s),r,n,i);else if(g(s)){if("string"!=typeof n)throw new Error("Cannot use higher-order sections without the original template");null!=(s=s.call(t.view,n.slice(e[3],e[5]),(function(e){return a.render(e,t,r,i)})))&&(o+=s)}else o+=this.renderTokens(e[4],t,r,n,i);return o}},R.prototype.renderInverted=function(e,t,r,n,i){var a=t.lookup(e[1]);if(!a||m(a)&&0===a.length)return this.renderTokens(e[4],t,r,n,i)},R.prototype.indentPartial=function(e,t,r){for(var n=t.replace(/[^ \t]/g,""),i=e.split("\n"),a=0;a<i.length;a++)i[a].length&&(a>0||!r)&&(i[a]=n+i[a]);return i.join("\n")},R.prototype.renderPartial=function(e,t,r,n){if(r){var i=this.getConfigTags(n),a=g(r)?r(e[1]):r[e[1]];if(null!=a){var o=e[6],s=e[5],c=e[4],l=a;0==s&&c&&(l=this.indentPartial(a,c,o));var u=this.parse(l,i);return this.renderTokens(u,t,r,l,n)}}},R.prototype.unescapedValue=function(e,t){var r=t.lookup(e[1]);if(null!=r)return r},R.prototype.escapedValue=function(e,t,r){var n=this.getConfigEscape(r)||I.escape,i=t.lookup(e[1]);if(null!=i)return"number"==typeof i&&n===I.escape?String(i):n(i)},R.prototype.rawValue=function(e){return e[1]},R.prototype.getConfigTags=function(e){return m(e)?e:e&&"object"==typeof e?e.tags:void 0},R.prototype.getConfigEscape=function(e){return e&&"object"==typeof e&&!m(e)?e.escape:void 0};var I={name:"mustache.js",version:"4.2.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(e){O.templateCache=e},get templateCache(){return O.templateCache}},O=new R;I.clearCache=function(){return O.clearCache()},I.parse=function(e,t){return O.parse(e,t)},I.render=function(e,t,r,n){if("string"!=typeof e)throw new TypeError('Invalid template! Template should be a "string" but "'+((m(i=e)?"array":typeof i)+'" was given as the first argument for mustache#render(template, view, partials)'));var i;return O.render(e,t,r,n)},I.escape=function(e){return String(e).replace(/[&<>"'`=\/]/g,(function(e){return T[e]}))},I.Scanner=q,I.Context=k,I.Writer=R;var P=I;const C=e=>{e.classList.add("pw-a-video__asset--initialized");const i=e.querySelector("video"),a=e.querySelector(".pw-a-video__poster");let o=!1;const s=e=>{e.forEach((e=>{null!==i.offsetParent&&(!o&&e.isIntersecting&&(Array.from(i.children).forEach((e=>{"string"==typeof e.tagName&&"SOURCE"===e.tagName&&(e.src=e.dataset.src)})),i.load(),o=!0),a&&a.addEventListener("click",(()=>{Y(i)})),0!==e.intersectionRatio?!0===i.autoplay&&Y(i):function(e){x(e)&&e.pause()}(i))}))};if(i){i.addEventListener("playing",(()=>{a.classList.add("pw-a-video__poster--hidden"),M(t,i)})),i.addEventListener("pause",(()=>{M(r,i)})),i.addEventListener("ended",(()=>{a.classList.remove("pw-a-video__poster--hidden"),M(n,i)}));new IntersectionObserver(s,{threshold:[0,.01]}).observe(i)}};function M(e,t){t.autoplay||u(e,"video",t.currentSrc,Math.round(t.duration),Math.round(t.currentTime))}function x(e){return!!(e.currentTime>0&&!e.paused&&!e.ended&&e.readyState>2)}function Y(e){x(e)||e.play()}const K=(e=document)=>{const t=e.querySelectorAll(".pw-a-video__asset:not(.pw-a-video__asset--initialized)");Array.from(t).forEach((e=>{C(e)}))},D="KEY_JUST_NOW",H="KEY_ONE_MINUTE",z="KEY_MINUTES",Q="KEY_ONE_HOUR",j="KEY_HOURS",B="KEY_ONE_DAY",$="KEY_DAYS",W="KEY_ONE_WEEK",V="KEY_WEEKS",F="KEY_ONE_MONTH",J="KEY_MONTHS",G="KEY_ONE_YEAR",Z="KEY_YEARS",X=e=>{const t=e.querySelector("#pwsg-timeago");if(!t)return;const r={KEY_JUST_NOW:t.dataset.justnow,KEY_ONE_MINUTE:t.dataset.oneminute,KEY_MINUTES:t.dataset.minutes,KEY_ONE_HOUR:t.dataset.onehour,KEY_HOURS:t.dataset.hours,KEY_ONE_DAY:t.dataset.oneday,KEY_DAYS:t.dataset.days,KEY_ONE_WEEK:t.dataset.oneweek,KEY_WEEKS:t.dataset.weeks,KEY_ONE_MONTH:t.dataset.onemonth,KEY_MONTHS:t.dataset.months,KEY_ONE_YEAR:t.dataset.oneyear,KEY_YEARS:t.dataset.years},n=e.querySelectorAll(".pw-a-timeago:not(.initialized)"),i=new Date;Array.from(n).forEach((e=>{if(e.dataset.datetime){const t=new Date(e.dataset.datetime);if(t<i){e.classList.add("initialized");let n=function(e){if(!e)return null;const t=31,r=365,n=new Date,i=Math.abs(Math.round((n-e)/1e3)),a=Math.floor(i/60),o=function(e){const t=new Date,r=Math.abs(e.getTime()-t.getTime());return Math.floor(r/36e5)}(e),s=function(e){const t=new Date,r=e.getTime()-t.getTime();return Math.round(Math.abs(r/864e5))}(e),c=Math.floor(s/t),l=Math.floor(s/r);if(e>n)return;if(l>=1)return l>1?[Z,l]:[G,l];if(c>=1)return c>1?[J,c]:[F,c];if(s>=7)return s<14?[W,1]:s<21?[V,2]:s<28?[V,3]:[V,4];if(s>=1)return s>1?[$,s]:[B,s];if(o>=1)return o>1?[j,o]:[Q,o];if(a>=1)return a>1?[z,a]:[H,a];return[D,i]}(t),i=r[n[0]].replace("{{value}}",String(n[1]));e.insertAdjacentHTML("beforeend",i)}}}))};const ee=e=>{if(e.classList.add("initialized"),!(document.body.clientWidth>1024)){const t=e.querySelectorAll("[id^='socialteaser-']"),r="pw-socialteaser--active";let n;const i=e=>{t[e].classList.add(r),t[e].querySelector("a").style.pointerEvents="auto",n!=e&&(n>=0?(a(n),n=e):n=e)},a=e=>{t[e].classList.remove(r),t[e].querySelector("a").style.pointerEvents="none"};Array.from(t).forEach(((e,r)=>{let n;n=e.id,e.querySelector('[on="tap:pw-set-activeTeaser.'+n+'"]')&&t[r].addEventListener("click",(()=>i(r))),a(r)}))}};const te=(e=document)=>{const t=e.querySelectorAll(".socialgrid:not(.initialized)");Array.from(t).forEach((e=>{ee(e),((e=document)=>{X(e)})(e)}))},re=e=>{e.classList.add("initialized");const t=e.querySelector(".pw-a-data-list__list"),r=e.querySelector(".pw-a-data-list__load-more"),n=r.querySelector(".pw-a-data-list__button"),i=e.querySelector('template[type="x-tmpl-mustache"]'),a="pw--hidden",o=e.dataset.src||"",s=e.dataset.items||"items",c=e.dataset.loadMoreBookmark||"load-more-src";let l="";const u=e=>{e&&fetch(e).then((e=>{if(!e.ok)throw new Error("Network response was not OK");return e.json()})).then((e=>{let o=e[s];l=e[c],o&&(Array.from(o).forEach((e=>{t.insertAdjacentHTML("beforeend",P.render(i.innerHTML,e))})),K(t),f(t),((e=document)=>{let t=e.parentElement;for(;null!=t&&!t.classList.contains("socialgrid");)t=t.parentElement;null!=t&&ee(t)})(t),((e=document)=>{let t=e.parentElement;for(;null!=t&&!t.classList.contains("socialgrid");)t=t.parentElement;null!=t&&t.classList.contains("socialgrid")&&X(t)})(t),p(t)),l?r.classList.remove(a):(r.classList.add(a),n.removeEventListener("click",(()=>u())))})).catch((e=>{console.error("There has been a problem with your fetch operation:",e)}))};o&&u(o),n.addEventListener("click",(()=>u(l)))},ne=e=>{e.classList.add("initialized");const t="pw--hidden",r="pw--visible",n=()=>{e.classList.remove(r),e.classList.add(t)};let i=e.id,a=document.querySelectorAll('[on="tap:'+i+'"]');Array.from(a).forEach((n=>{n.addEventListener("click",(()=>(e.classList.add(r),void e.classList.remove(t))))}));let o=e.querySelectorAll('[on="tap:'+i+'.close"]');Array.from(o).forEach((e=>{e.addEventListener("click",(()=>n()))})),n()},ie=()=>{(()=>{const e=document.querySelector(".js-nav"),t=document.querySelector(".js-nav-search");e&&t&&(t.addEventListener("focus",(function(){e.classList.add("search")})),t.addEventListener("blur",(function(){e.classList.remove("search")})))})();const e=document.querySelectorAll("pwa-lightbox:not(.initialized)");Array.from(e).forEach((e=>{ne(e)}))};function ae(e){e.classList.add("initialized");const t=e.querySelector(".pw-m-carousel__scroll-wrapper"),r=e.querySelector(".pw-m-carousel__button--previous"),n=e.querySelector(".pw-m-carousel__button--next"),i=e.querySelectorAll(".pw-m-carousel__slide"),[a]=i,o=["1","true",!0].includes(e?.dataset?.loop),s=e.querySelector(".pw-m-carousel__pagination-index"),c=e.querySelector(".pw-m-carousel__pagination-count"),l=e.querySelector(".pw-m-carousel__caption"),u=e.querySelector(".pw-a-copyright");let d,p=a,h=Array.from(i);const f=h.length;h.forEach(((e,t)=>{e.setAttribute("data-index",t)}));let y=parseInt(p?.dataset?.index??0,10);h.forEach(((e,t)=>{e.setAttribute("data-index",t)})),o&&(Array.from(i).forEach((e=>{const r=e.cloneNode(!0);r.setAttribute("data-clone",!0),t.append(r),h=[...h,r]})),Array.from(i).reverse().forEach((e=>{const r=e.cloneNode(!0);r.setAttribute("data-clone",!0),t.prepend(r),h=[r,...h]})));const m=()=>{if(r){const e=t.scrollLeft<=0;r.setAttribute("aria-disabled",e)}if(n){const e=Math.ceil(t.offsetWidth+t.scrollLeft)>=t.scrollWidth;n.setAttribute("aria-disabled",e)}},g=()=>{const{scrollLeft:e}=t;if(Array.from(h).forEach((t=>{const r=Math.abs(t.offsetLeft-e);Math.ceil(r)<t.clientWidth&&(p=t)})),p?.dataset?.clone){const e=Array.from(i).find((e=>p?.dataset?.index===e?.dataset?.index));e&&(t.scrollLeft=e.offsetLeft,p=e)}if(y=parseInt(p?.dataset?.index??0,10),s){const e=`${y+1}`;s.innerText=e}if(c){const e=`${f}`;c.innerText=e}if(l){const e=`${p?.dataset?.caption||""}`;l.innerText=e}if(u){const e=`${p?.dataset?.copyright||""}`;u.innerText=e}m()},E=(e,r=1)=>{e.preventDefault();const n=((e=1)=>e>0?p.nextElementSibling||p:p.previousElementSibling||p)(r);n&&t.scrollBy({left:r*n.clientWidth,behavior:"smooth"})};t.addEventListener("scroll",(()=>{d&&clearTimeout(d),d=setTimeout(g,50)}),{passive:!0}),r?.addEventListener("click",(e=>E(e,-1))),n?.addEventListener("click",(e=>E(e,1))),m()}const oe=e=>{se(10,"Init"),e.classList.add("initialized");var t="PushManager"in window||"safari"in window&&"pushNotification"in window.safari,r=/Edge/.test(navigator.userAgent),n=/SamsungBrowser/.test(navigator.userAgent),i=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);function a(){se(206,"failedPushNotification");var t=e&&e.querySelector(".pwp__m--f");t&&t.classList.add("pw--visible")}function o(t){const r=e.getElementsByTagName("button")[0];if(r){const e=function(e){try{var t=e.dataset;if(t.key)return JSON.parse('{"pw_event":" '+t.key+'"}');if(t.json)return JSON.parse(t.json||"")}catch(e){se(319,e)}return""}(r);Object.keys(e).forEach((function(r){const n=r,i=e[r].split(",");for(var a=0;a<i.length;a++)se(310,"updateAirshipTags",i[a]),t.add(i[a],n)}))}}function s(e,t,r){void 0===e&&(e=10),void 0!==window.UA?(se(260,"SDK loaded "+t+"("+e+")"),r()):e>0?(se(262,"SDK loading..."+t+"("+e+")"),function(e,t,r,n,i){var a,o="Promise"in e,s={then:function(){return s},catch:function(e){return e(new Error("Airship SDK Error: Unsupported browser")),s}},c=o?new Promise((function(e,t){a=function(r,n){r?t(r):e(n)}})):s;c._async_setup=function(e){if(o)try{a(null,e(i))}catch(e){a(e)}},e.UA=c;var l=t.createElement("script");l.src="https://aswpsdkeu.com/notify/v1/ua-sdk.min.js",l.async=!0,l.id="_uasdk",l.rel="UA",t.head.appendChild(l)}(window,document,0,0,function(e){return Object.assign({workerUrl:"/sw-content.js"},function(e){return-1!=e.indexOf("test")?{websitePushId:"web.com.bmw.int",vapidPublicKey:"BP15iBPJ6UDByPcPJDxCrGTkSH9DSvGfdUZrWchWCNmrHu2GX7LLIzgI2rCdRyOk0FE3No6cqKiL3i9G-5g4K94=",appKey:"uppmHO2pQMKcUe7ohKVgww",token:"MTp1cHBtSE8ycFFNS2NVZTdvaEtWZ3d3OlM5bUZCQ0xlV0VJTFZ4dTdYbGRrR3V1dmVhYTYwYnphcExBRUo3OEZQYUk"}:{websitePushId:"web.com.bmw",vapidPublicKey:"BFN9keUV5N21Ix5vEA2tzGJLQSNb8wokYW3ree50MxBowa-zP8_8dptRBeL91pgC8dqV2cG573CjxhIhXgUfoqU=",appKey:"nJkHmgZjSiWtaW2V83XPEw",token:"MTpuSmtIbWdaalNpV3RhVzJWODNYUEV3OlhzczZfOUdaeEhqd0g4b0lYZ25yeTdjeHhOTThFYlBnVTdWbURXZkhrN3M"}}(e))}(t)),window.setTimeout((function(){s(e-1,t,r)}),200)):se(269,"SDK loading failed.")}function c(){se(200,"Command: readyForSafari")}return function(){if(e&&t&&!n&&!r){se(100,"Supported");var l=0,u="",d=document.getElementById("pwp__notification-button");if(d){se(110,"Button found");try{l=parseInt(d.dataset.config||"222",10),u=d.dataset.domain,se(112,"Config "+l+" "+u)}catch(e){se(119,e)}function t(){se(350,"Process PN 2.0"),function(){se(207,"hidePushNotification");var t=e&&e.querySelector(".pwp__m--s");t&&t.classList.remove("pw--visible");var r=e&&e.querySelector(".pwp__m--f");r&&r.classList.remove("pw--visible")}(),UA.then((t=>{t.canRegister&&t.isSupported&&t.register().then((t=>{t.opt_in&&(se(110,"OptIn with "+t.channel_id),o(t.tags),function(){if(se(205,"activePushNotification"),e){var t=e.querySelector(".pwp__m--s");t&&t.classList.add("pw--visible");var r=e.querySelector(".pwp__m--f");r&&r.classList.remove("pw--visible");var n=e.getElementsByTagName("button")[0];if(n){var i;n.classList.add("pw--active");var a=document.getElementById("pwp__notification-button");a&&a.dataset&&a.dataset.subscribed&&(i=a.dataset.subscribed);var o=e.getElementsByClassName("pw-teaser__date");if(o.length>0){for(var s=0,c=o.length;s<c-1;s++)o[0].remove();o[0].innerHTML=i}}}}())})).catch((e=>{se(108,"Register error "+e),a()})),"denied"==t.permission&&(se(110,"Permission denied"),a())})).catch((function(e){se(111,"SDK error"+e),a()}))}128&l&&i&&s(10,u,c);var p=e.getElementsByTagName("button")[0];p&&(se(110,"Trigger Button found"),p.addEventListener("click",function(){if(128&l&&!i)try{s(10,u,t)}catch(e){se(113,"SDK error"+e),a()}else t()}.bind(this))),e.classList.contains("pwp")&&e.classList.add("pwp--v"),p&&(p.disabled=!1),se(260,"done.")}else se(105,"Not supported: "+e+","+t+","+!n+","+!r)}}()};function se(e,t){try{"true"===localStorage.getItem("PW::debug")&&console.log("*** Push Notification: ",e,"-",t)}catch(e){}}const ce=e=>{!function(e="",t=""){try{"true"===localStorage.getItem("PW::debug")&&console.log("*** Search: ",e,"-",t)}catch(e){}}(10,"Init"),e.classList.add("initialized"),new le(e)};function le(e){this.apiEndpoint=e.getAttribute("data-gsap-api-endpoint"),e&&this.apiEndpoint&&(this.$queryInput=e.querySelector(le.QUERY_INPUT_ID),this.$result=e.querySelector(le.RESULT_ID),this.$resultList=e.querySelector(le.RESULT_LIST_ID),this.$resultCount=e.querySelector(le.RESULT_COUNT_ID),this.$resultQuery=e.querySelector(le.RESULT_QUERY_ID),this.$loadMoreButton=e.querySelector(le.LOAD_MORE_BUTTON_ID),this.$maxResultCount=e.querySelector(le.MAX_RESULT_COUNT_ID),this.currentQuery="",this.results={},this.renderedQuery="",this.queryInputTimeout=null,this.currentPage=0,this.render(),this.currentQuery=this.getQueryFromUrl(),this.currentQuery&&(this.getSearchResults(),this.$queryInput.value=this.currentQuery),this.$loadMoreButton.addEventListener("click",this.loadMoreButtonHandler.bind(this)),this.$queryInput.addEventListener("input",this.queryInputHandler.bind(this)))}le.GET_PARAMETER_NAME="q",le.QUERY_INPUT_ID="#pw-search-input",le.RESULT_ID="#pw-search-result",le.RESULT_LIST_ID="#pw-search-result-list",le.RESULT_COUNT_ID="#pw-search-result-count",le.RESULT_QUERY_ID="#pw-search-query",le.LOAD_MORE_BUTTON_ID="#pw-search-load-more",le.MAX_RESULT_COUNT_ID="#pw-search-max-result-count",le.RESULT_COUNT_TO_FETCH=5,le.INPUT_THRESHOLD=3,le.INPUT_DELAY=500,le.prototype.getQueryFromUrl=function(){for(var e="",t=window.location.search.substr(1).split("&"),r=[],n=0;n<t.length;n++)if((r=t[n].split("="))[0]===le.GET_PARAMETER_NAME){e=decodeURIComponent(r[1]).trim();break}return e},le.prototype.loadMoreButtonHandler=function(e){this.currentPage=this.currentPage+1,this.render()},le.prototype.queryInputHandler=function(e){this.queryInputTimeout&&clearTimeout(this.queryInputTimeout),this.$queryInput.value.length>=le.INPUT_THRESHOLD&&(this.queryInputTimeout=setTimeout(this.evaluateTypedQuery.bind(this),le.INPUT_DELAY))},le.prototype.evaluateTypedQuery=function(){var e=this.$queryInput.value.trim();this.typedQuery!==this.renderedQuery&&(this.currentQuery=e,this.getSearchResults())},le.prototype.doApiRequest=function(e,t,r){var n=new XMLHttpRequest;n.addEventListener("readystatechange",(function(){4!==this.readyState||200!==this.status?4==this.readyState&&"function"==typeof r&&r(this):"function"==typeof t&&t(this)})),n.open("GET",e),n.send()},le.prototype.getApiEndpointSearch=function(e){return this.apiEndpoint+encodeURI(e)},le.prototype.getSearchResults=function(){if(this.currentQuery){var e=this.getApiEndpointSearch(this.currentQuery);this.doApiRequest(e,this.searchResultsSuccessHandler.bind(this),this.searchResultsErrorHandler.bind(this))}},le.prototype.searchResultsSuccessHandler=function(e){var t={};try{(t="object"!=typeof e.response?JSON.parse(e.response):e.response).GSP.hasOwnProperty("RES")?this.results=t.GSP.RES.R.filter((function(e){return Boolean(e.U)&&Boolean(e.S)&&Boolean(e.T)})):this.results=[]}catch(t){return console.error("Failed parsing API response",t,e.response),void this.searchResultsErrorHandler(e)}this.render()},le.prototype.searchResultsErrorHandler=function(e){console.error("Requesting GSA failed:",e),this.results=[],this.render()},le.prototype.render=function(){if(this.currentQuery?this.$result.style.display="block":this.$result.style.display="none",this.currentQuery!==this.renderedQuery){for(;this.$resultList.lastChild;)this.$resultList.removeChild(this.$resultList.lastChild);this.currentPage=0,this.renderedQuery="",this.renderedQuery=this.currentQuery,this.$resultQuery.innerText=this.renderedQuery}for(var e=this.currentPage*le.RESULT_COUNT_TO_FETCH,t=Math.min(this.results.length,e+le.RESULT_COUNT_TO_FETCH),r=e;r<t;r++){var n=this.results[r],a=this.createResultNode(n);this.$resultList.appendChild(a)}this.$resultCount.innerText=t,this.$maxResultCount.innerText=this.results.length,t>=this.results.length?this.$loadMoreButton.style.display="none":this.$loadMoreButton.style.display="block",this.currentQuery&&0==this.currentPage&&((e,t,r)=>{d(60,"trackSearchEvent");let n="local > search filters applied",a={searchResults:r};d(62,"arguments: "+n+", query:"+e+" ",a),i.isTracyAvailable&&window.tracy&&(e?window.tracy.searchFilter.add("user selected","na","onsite search",e):window.tracy.searchFilter.reset(),window.tracy.event(n,a))})(this.currentQuery,0,this.results.length)},le.prototype.createResultNode=function(e){var t=document.createElement("li");return t.innerHTML='<a href="'+e.U+'"><strong>'+e.T+"</strong><p>"+e.S+"</p></a>",t};function ue(e,t){"function"==typeof e.scrollIntoView?e.scrollIntoView({behavior:"smooth"}):document.documentElement.scrollTop=t+e.offsetTop}const de=(e=document)=>{const t=e.querySelectorAll('[href^="#pwjt"]:not(.initialized)');Array.from(t).forEach((t=>{((e,t)=>{t.classList.add("initialized");const r=t=>{const r=RegExp(/^.*#pwjt/);let n=e.querySelector(t.target.href.replace(r,"#pwjt"));n&&(ue(n.parentElement,n.parentElement.offsetTop),t.preventDefault())};t.removeEventListener("click",(e=>r(e))),t.addEventListener("click",(e=>r(e)))})(e,t)})),function(e){let t=document.location.hash;if(t){const r=RegExp(/#pwjt-[\w]*/);let n=t.match(r);if(null!=n){let t=e.querySelector(n[0]);t&&setTimeout((function(){ue(t.parentElement,t.parentElement.offsetTop)}),100)}}}(e)};(()=>{var t;e(),((e=document)=>{d(10,"initTracking");let t=e.querySelectorAll("#inline-tracking:not(.initialized)");Array.from(t).forEach((e=>{a(e)}))})(),((e=document)=>{const t=e.querySelectorAll(".cookie:not(.initialized)");Array.from(t).forEach((e=>{(e=>{e.classList.add("initialized");let t=e.nextElementSibling;for(;null!=t;)t.style.display="none",t=t.nextElementSibling})(e)}))})(),f(),((e=document)=>{const t=e.querySelectorAll(".pw-a-data-list:not(.initialized)");Array.from(t).forEach((e=>{re(e)}))})(),ie(),K(),((e=document)=>{const t=e.querySelectorAll(".pw-m-carousel:not(.initialized)");Array.from(t).forEach((e=>{ae(e)}))})(),t=document.querySelectorAll(".pwp:not(.initialized), .js-notification-button:not(.initialized)"),Array.from(t).forEach((e=>{oe(e)})),(()=>{const e=document.querySelector(".pw-t-search:not(.initialized)");e&&ce(e)})(),te(),de()})()}();